<!doctype html><html lang=es><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Instalar, configurar y securizar MariaDB - Mis notas</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="Juan Asensio"><meta name=description content="La página de IBM developerWorks no para de sorprenderme. Muchas de las veces que busco documentación técnica, cursos, tutoriales, etc. allí están ellos, y con un material gratuito y de muy alta calidad. La última, fue con la instalación de este blog. Tengo un VPS contratado con Ubuntu, que he ido actualizando poco a poco, y que lo tengo bastante pelado. Me decidí por instalar en él WordPress (tras mucho analizar otros sistemas para publicar artículos tipo Dokuwiki, Octopress, Jekyll, Pelican, etc.). Lo primero que me sorprendió es que no soporta PostgreSQL de forma oficial (que sería mi primera opción), por mis reticencias con MySQL, pero más tarde de acordé del fork que se creó hace un tiempo, llamado MariaDB. Leyendo un poco, parece ser que MariaDB es &amp;ldquo;binariamente&amp;rdquo; (si es que eso existe en castellano) compatible con MySQL (es decir, que el protocolo de comunicación, los ficheros de base de datos, etc. son totalmente compatibles, si no iguales)."><meta name=keywords content="okelet,linux,bash,python,aws,google,cloud,gcloud"><meta name=generator content="Hugo 0.64.1 with even 4.0.0"><link rel=canonical href=https://okelet.netlify.com/posts/2014/08/instalar-configurar-y-securizar-mariadb/><link href=https://okelet.netlify.com/atom.xml type=application/atom+xml rel=alternate title="Mis notas - Atom"><link href=https://okelet.netlify.com/index.xml type=application/rss+xml rel=alternate title="Mis notas - RSS"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=/dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=https://okelet.netlify.com/css/custom.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.9.0/css/all.css><meta property="og:title" content="Instalar, configurar y securizar MariaDB"><meta property="og:description" content="La página de IBM developerWorks no para de sorprenderme. Muchas de las veces que busco documentación técnica, cursos, tutoriales, etc. allí están ellos, y con un material gratuito y de muy alta calidad. La última, fue con la instalación de este blog. Tengo un VPS contratado con Ubuntu, que he ido actualizando poco a poco, y que lo tengo bastante pelado. Me decidí por instalar en él WordPress (tras mucho analizar otros sistemas para publicar artículos tipo Dokuwiki, Octopress, Jekyll, Pelican, etc.). Lo primero que me sorprendió es que no soporta PostgreSQL de forma oficial (que sería mi primera opción), por mis reticencias con MySQL, pero más tarde de acordé del fork que se creó hace un tiempo, llamado MariaDB. Leyendo un poco, parece ser que MariaDB es &ldquo;binariamente&rdquo; (si es que eso existe en castellano) compatible con MySQL (es decir, que el protocolo de comunicación, los ficheros de base de datos, etc. son totalmente compatibles, si no iguales)."><meta property="og:type" content="article"><meta property="og:url" content="https://okelet.netlify.com/posts/2014/08/instalar-configurar-y-securizar-mariadb/"><meta property="article:published_time" content="2014-08-07T13:49:42+02:00"><meta property="article:modified_time" content="2014-08-07T13:49:42+02:00"><meta itemprop=name content="Instalar, configurar y securizar MariaDB"><meta itemprop=description content="La página de IBM developerWorks no para de sorprenderme. Muchas de las veces que busco documentación técnica, cursos, tutoriales, etc. allí están ellos, y con un material gratuito y de muy alta calidad. La última, fue con la instalación de este blog. Tengo un VPS contratado con Ubuntu, que he ido actualizando poco a poco, y que lo tengo bastante pelado. Me decidí por instalar en él WordPress (tras mucho analizar otros sistemas para publicar artículos tipo Dokuwiki, Octopress, Jekyll, Pelican, etc.). Lo primero que me sorprendió es que no soporta PostgreSQL de forma oficial (que sería mi primera opción), por mis reticencias con MySQL, pero más tarde de acordé del fork que se creó hace un tiempo, llamado MariaDB. Leyendo un poco, parece ser que MariaDB es &ldquo;binariamente&rdquo; (si es que eso existe en castellano) compatible con MySQL (es decir, que el protocolo de comunicación, los ficheros de base de datos, etc. son totalmente compatibles, si no iguales)."><meta itemprop=datePublished content="2014-08-07T13:49:42+02:00"><meta itemprop=dateModified content="2014-08-07T13:49:42+02:00"><meta itemprop=wordCount content="685"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Instalar, configurar y securizar MariaDB"><meta name=twitter:description content="La página de IBM developerWorks no para de sorprenderme. Muchas de las veces que busco documentación técnica, cursos, tutoriales, etc. allí están ellos, y con un material gratuito y de muy alta calidad. La última, fue con la instalación de este blog. Tengo un VPS contratado con Ubuntu, que he ido actualizando poco a poco, y que lo tengo bastante pelado. Me decidí por instalar en él WordPress (tras mucho analizar otros sistemas para publicar artículos tipo Dokuwiki, Octopress, Jekyll, Pelican, etc.). Lo primero que me sorprendió es que no soporta PostgreSQL de forma oficial (que sería mi primera opción), por mis reticencias con MySQL, pero más tarde de acordé del fork que se creó hace un tiempo, llamado MariaDB. Leyendo un poco, parece ser que MariaDB es &ldquo;binariamente&rdquo; (si es que eso existe en castellano) compatible con MySQL (es decir, que el protocolo de comunicación, los ficheros de base de datos, etc. son totalmente compatibles, si no iguales)."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--><link rel=stylesheet type=text/css href=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css><script src=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js></script><script>window.addEventListener("load",function(){window.cookieconsent.initialise({"palette":{"popup":{"background":"#000"},"button":{"background":"#f1d600"}},"theme":"classic"})});</script></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>Mis notas</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Inicio</li></a><a href=/posts/><li class=mobile-menu-item>Archivos</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/pages/projects/><li class=mobile-menu-item>Proyectos</li></a><a href=/pages/about/><li class=mobile-menu-item>Acerca de</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>Mis notas</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Inicio</a></li><li class=menu-item><a class=menu-item-link href=/posts/>Archivos</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/pages/projects/>Proyectos</a></li><li class=menu-item><a class=menu-item-link href=/pages/about/>Acerca de</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Instalar, configurar y securizar MariaDB</h1><div class=post-meta><span class=post-time>2014-08-07</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contenidos</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#referencias>Referencias</a></li></ul></li></ul></nav></div></div><div class=post-outdated><div class=warn><p>[NOTA] Actualizado <span class=timeago datetime=2014-08-07T13:49:42 title="August 7, 2014">August 7, 2014</span>. Este artículo puede contener contenido desactualizado.</p></div></div><div class=post-content><p>La página de <a href=http://www.ibm.com/developerworks>IBM developerWorks</a> no para de sorprenderme. Muchas de las veces que busco documentación técnica, cursos, tutoriales, etc. allí están ellos, y con un material gratuito y de muy alta calidad. La última, fue con la instalación de este blog. Tengo un VPS contratado con Ubuntu, que he ido actualizando poco a poco, y que lo tengo bastante pelado. Me decidí por instalar en él WordPress (tras mucho analizar otros sistemas para publicar artículos tipo <a href=http://dokuwiki.org>Dokuwiki</a>, <a href=http://octopress.org>Octopress</a>, <a href=http://jekyllrb.com>Jekyll</a>, <a href=http://getpelican.com>Pelican</a>, etc.). Lo primero que me sorprendió es que no soporta <a href=http://www.postgresql.org>PostgreSQL</a> de forma oficial (que sería mi primera opción), por mis <a href=http://techcrunch.com/2012/08/18/oracle-makes-more-moves-to-kill-open-source-mysql>reticencias con MySQL</a>, pero más tarde de acordé del fork que se creó hace un tiempo, llamado <a href=http://mariadb.org>MariaDB</a>. Leyendo un poco, parece ser que MariaDB es &ldquo;binariamente&rdquo; (si es que eso existe en castellano) <a href=https://mariadb.com/kb/en/mariadb/mariadb-vs-mysql-compatibility>compatible con MySQL</a> (es decir, que el protocolo de comunicación, los ficheros de base de datos, etc. son totalmente compatibles, si no iguales).</p><p>Bueno, a lo que iba. Ya que con PostgreSQL no se puede (o por lo menos, no está oficialmente soportado), opté por instalar MariaDB. Desde su web tienen un <a href=https://downloads.mariadb.org/mariadb/repositories>asistente muy sencillo</a> para configurar los repositorios de las distribuciones Linux más comunes (openSUSE, Debian, Ubuntu, Red Hat, CentOS, etc.). Tienen paquetes precompilados para prácticamente todas las versiones y arquitecturas (la única que echo en falta es Red Hat 7, aunque se lo perdono porque acaba de salir hace nada&mldr;).</p><p>Una vez configurados los repositorios, toca la parte de la instalación; sencillísima como siempre:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>sudo apt-get update
sudo apt-get install mariadb-server php5-mysql
</code></pre></td></tr></table></div></div><p>Lo que más miedo me da de estas instalaciones tan &ldquo;sencillísimas&rdquo; es que muchas veces dejan el servidor o el servicio instalado bastante desprotegido. Durante la instalación, se nos pregunta que si queremos ponerle una contraseña al usuario root de MariaDB/MySQL&mldr;. Pero qué cosas, nos permite dejarlo en blanco. MAL MAL MAL. Como decía, gracias a los tutoriales de developerWorks, descubrí que hay un comando muy sencillo que te &ldquo;quita&rdquo; todas esas inseguridades; a saber:</p><ul><li>Ponerle una contraseña al usuario root de MariaDB/MySQL en condiciones.</li><li>Eliminar el usuario anonymous</li><li>Deshabilitar el acceso remoto de root</li><li>Eliminar la base de datos test</li><li>Recargar los privilegios</li></ul><p>El comando mágico es <code>mysql_secure_installation</code>, aunque parece que no está muy afinado, ya que nada más lanzarlo da un error:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-text data-lang=text>/usr/bin/mysql_secure_installation: 379: /usr/bin/mysql_secure_installation: find_mysql_client: not found
</code></pre></td></tr></table></div></div><p>También da un error al intentar borrar la base de datos test:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-text data-lang=text>Remove test database and access to it? [Y/n]
 - Dropping test database...
ERROR 1008 (HY000) at line 1: Can&#39;t drop database &#39;test&#39;; database doesn&#39;t exist
 ... Failed!  Not critical, keep moving...
 - Removing privileges on test database...
 ... Success!
</code></pre></td></tr></table></div></div><p>Puedes ver la salida completa del comando en este <a href=https://gist.github.com/okelet/b416b13f85831afb98fe>Gist</a>.</p><p>Una vez hecho esto, ya podemos decir que nuestra instalación está bastante adecentada. Lo que nos quedaría, si usamos un cortafuegos (que deberíamos), sería limitar el acceso. Si la regla por defecto es denegar las conexiones entrantes, no deberíamos tener problema; si no, deberíamos añadir una regla para denegar las conexiones remotas entrantes al puerto 3306. El siguiente listado muestra los comandos necesarios para configurar el cortafuegos de manera rápida con <a href=https://help.ubuntu.com/community/UFW>UFW</a>, permitiendo el acceso desde fuera por SSH, HTTP y HTTPS, denegando todo el resto de tráfico entrante, y permitiendo por defecto el tráfico saliente:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>sudo apt-get install ufw
sudo ufw <span class=nb>enable</span>
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh/tcp
sudo ufw allow http/tcp
sudo ufw allow https/tcp
sudo ufw status
</code></pre></td></tr></table></div></div><p>Por último, y como algo particular para WordPress, crearemos una base de datos, un usuario y le daremos permisos al usuario sobre esa base de datos, para lo que ejecutaremos el comando <code>mysql -uroot -p</code>, introduciendo después la contraseña asignada antes al usuario root, y ejecutando los siguientes comandos desde el shell de MariaDB:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=k>CREATE</span> <span class=k>DATABASE</span> <span class=n>wordpress</span><span class=p>;</span>
<span class=k>CREATE</span> <span class=k>USER</span> <span class=s1>&#39;</span><span class=s1>wpuser</span><span class=s1>&#39;</span><span class=o>@</span><span class=s1>&#39;</span><span class=s1>localhost</span><span class=s1>&#39;</span> <span class=n>IDENTIFIED</span> <span class=k>BY</span> <span class=s1>&#39;</span><span class=s1>pickApassword</span><span class=s1>&#39;</span><span class=p>;</span>
<span class=k>GRANT</span> <span class=k>ALL</span> <span class=k>PRIVILEGES</span> <span class=k>ON</span> <span class=n>wordpress</span> <span class=p>.</span><span class=o>*</span> <span class=k>TO</span> <span class=s1>&#39;</span><span class=s1>wpuser</span><span class=s1>&#39;</span><span class=o>@</span><span class=s1>&#39;</span><span class=s1>localhost</span><span class=s1>&#39;</span><span class=p>;</span>
<span class=n>FLUSH</span> <span class=k>PRIVILEGES</span><span class=p>;</span>
<span class=n>exit</span>
</code></pre></td></tr></table></div></div><h3 id=referencias>Referencias</h3><ul><li><a href=http://www.ibm.com/developerworks/cloud/library/cl-softlayer-secure-wordpressblog-trs>IBM developerWorks: Create a secure WordPress blog using SoftLayer</a></li></ul></div><footer class=post-footer><nav class=post-nav><a class=prev href=/posts/2014/08/red-nat-privada-con-salida-al-exterior-en-virtualbox/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Red NAT privada con salida al exterior en VirtualBox</span>
<span class="prev-text nav-mobile">Previo</span></a></nav></footer></article></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname==='localhost')return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='okeletgithubio';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=https://stackoverflow.com/users/576138/okelet class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=https://www.linkedin.com/in/okelet/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/okelet/ class="iconfont icon-github" title=github></a><a href=https://gitlab.com/okelet class="iconfont icon-gitlab" title=gitlab></a><a href=https://okelet.netlify.com/atom.xml type=application/atom+xml class="iconfont icon-rss" title="Atom feed"></a></div><div class=copyright><span class=power-by>Creado con <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Tema -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2017 -
2020
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Juan Asensio</span></span></div><script type=text/javascript>(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");ym(54019648,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src=https://mc.yandex.ru/watch/54019648 style=position:absolute;left:-9999px alt></div></noscript></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin=anonymous></script><script>var languageCode="es".replace(/-/g,'_').replace(/_(.*)/,function($0,$1){return $0.replace($1,$1.toUpperCase());});timeago().render(document.querySelectorAll('.timeago'),languageCode);timeago.cancel();</script><script type=text/javascript src=/dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-53728915-2','auto');ga('set','anonymizeIp',true);ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=/js/custom.js></script></body></html>